import{C as b,a9 as c,A as k,aa as I,ab as x,ac as $,l as v,ad as D,U as F,J as N,o as m,c as g,a as B,O as y,g as f,P,b as j,ae as q}from"./entry.C6KMa1dF.js";import{u as M}from"./asyncData.CwFjHVdC.js";function _(s,e,t){const[o={},r]=typeof e=="string"?[{},e]:[e,t],a=b(()=>{let l=s;return typeof l=="function"&&(l=l()),c(l)}),i=o.key||k([r,typeof a.value=="string"?a.value:"",...V(o)]);if(!i||typeof i!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+i);if(!s)throw new Error("[nuxt] [useFetch] request is missing.");const u=i===r?"$f"+i:i;if(!o.baseURL&&typeof a.value=="string"&&a.value[0]==="/"&&a.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:U,lazy:w,default:E,transform:R,pick:C,watch:p,immediate:L,getCachedData:S,deep:z,dedupe:A,...O}=o,h=I({...x,...O,cache:typeof o.cache=="boolean"?void 0:o.cache}),T={server:U,lazy:w,default:E,transform:R,pick:C,immediate:L,getCachedData:S,deep:z,dedupe:A,watch:p===!1?[]:[h,a,...p||[]]};let n;return M(u,()=>{var d;(d=n==null?void 0:n.abort)==null||d.call(n),n=typeof AbortController<"u"?new AbortController:{};const l=c(o.timeout);return l&&setTimeout(()=>n.abort(),l),(o.$fetch||globalThis.$fetch)(a.value,{signal:n.signal,...h})},T)}function V(s){var t;const e=[((t=c(s.method))==null?void 0:t.toUpperCase())||"GET",c(s.baseURL)];for(const o of[s.params||s.query]){const r=c(o);if(!r)continue;const a={};for(const[i,u]of Object.entries(r))a[c(i)]=c(u);e.push(a)}return e}async function G(s,e={}){var u;const{getSession:t}=useAuth(),o=v(),r=await t(),a={method:"GET",baseURL:o.public.apiUrl??"http://localhost:8090",headers:{Authorization:`Bearer ${(u=r==null?void 0:r.token)==null?void 0:u.access_token}`},lazy:!0,server:!1},i=$(e,a);return _(s,i,"$UqgiltlUfE")}const H=v(),J=D("user",{actions:{async LOAD_PROFILE_PICTURE_BLOB(s){this.profilePicture&&(await new Promise(e=>{try{URL.revokeObjectURL(this.profilePicture)}catch{}finally{e()}}),await new Promise(e=>{this.profilePicture=null,e()})),this.profilePicture=URL.createObjectURL(s)},async FETCH_PROFILE_PICTURE(){var t,o,r;this.loadingProfilePicture=!0;const{getSession:s}=useAuth(),e=await s();(o=(t=e==null?void 0:e.session)==null?void 0:t.user)!=null&&o.image&&_(e.session.user.image,{responseType:"blob",baseURL:H.public.apiUrl??"http://localhost:8090",key:"user-profile-picture",server:!0,lazy:!1,headers:{Authorization:`Bearer ${(r=e==null?void 0:e.token)==null?void 0:r.access_token}`}},"$vpSqNedazv").then(a=>{this.LOAD_PROFILE_PICTURE_BLOB(a.data.value)}).catch(a=>{console.error("There was a problem loading the profile picture. %o",a)}).finally(()=>{this.loadingProfilePicture=!1})},async UPDATE_PROFILE_PICTURE(s){if(useAuth(),this.loadingProfilePicture=!0,!!s)try{console.log("We have a file: %o",s),await new Promise(t=>setTimeout(t,1e3));const e=new FormData;e.append("image",s),G("/user/profile/picture",{method:"post",body:e}).then(t=>{console.log("Pinia Response: %o",t)}).catch(t=>{console.log("Pinia Error: %o",t)}).finally(()=>{this.loadingProfilePicture=!1})}catch{}finally{}}},getters:{shouldRememberUser(s){return s.rememberMe}},state:()=>({loadingProfilePicture:!0,profilePicture:null,rememberMe:!1})}),K=["xs","sm","lg","2x","3x","5x","7x","10x"],W=["alt","src"],Q={__name:"SimpleUserProfilePicture",props:{elevation:{type:[String,Number],requireD:!1,default(){return 2}},iconSize:{type:String,default(){return"lg"},validator(s){return K.includes(s)}},overlayIconClasses:{default(){return null}},overlayColor:{type:String,required:!1,default(){return"rgba(0, 0, 0, 0.8)"}},size:{type:[String,Number],requireD:!1,default(){return"2.1rem"}},animationMode:{type:String,default(){return"spin"},validator(s){return["pulse","spin"].includes(s)}}},setup(s){const e=J(),t=s,o=b(()=>{const r=[`fa-${t.animationMode}`,`fa-${t.iconSize}`];return t.overlayIconClasses&&r.push(t.overlayIconClasses),r});return e.FETCH_PROFILE_PICTURE(),F(()=>{console.log("Is Mounted")}),(r,a)=>{const i=N("fa-icon");return m(),g("div",{class:"position-relative",style:P({height:Number.isNaN(t.size)?t.size+"px":t.size,width:Number.isNaN(t.size)?t.size+"px":t.size,margin:`.15rem 0 .15rem ${(t.elevation||1)*2/10}rem`})},[B("img",{ref:"image",alt:r.$t("GENERAL.LABEL.USER_AVATAR"),class:y(["img-circle",`elevation-${s.elevation}`,"m-0"]),src:f(e).profilePicture||"/images/user-placeholder.png",style:{"object-fit":"cover",height:"100%",width:"100%"}},null,10,W),f(e).loadingProfilePicture?(m(),g("div",{key:0,class:"position-absolute d-flex align-items-center justify-content-around text-success rounded-circle",style:P({top:0,left:0,width:"100%",height:"100%","background-color":s.overlayColor})},[j(i,{icon:"spinner",class:y(f(o))},null,8,["class"])],4)):q("",!0)],4)}}},te=Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"}));export{te as S,Q as _,_ as u};
//# sourceMappingURL=SimpleUserProfilePicture.Lve9yFc0.js.map
